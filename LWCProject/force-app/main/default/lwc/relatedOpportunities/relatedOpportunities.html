<template>
    <lightning-card title="Related Opportunities" icon-name="standard:opportunity" >
        <lightning-button variant="outline-brand" label="Create Opportunity" onclick={handleCreateOpportunity}></lightning-button>

        <template if:true={opportunities}>
            <lightning-datatable
                key-field="Id"
                data={opportunities}
                columns={columns}
                hide-checkbox-column="true"
                onrowaction={handleRowAction}>
            </lightning-datatable>
        </template>

        <template if:true={error}>
            <c-error-panel errors={error}></c-error-panel>
        </template>

        <template if:true={hasNoOpportunities}>
            <p>No related opportunities found.</p>
        </template>
        
        <template if:true={isCreateModalOpen}>
            <c-create-opportunity 
                account-id={accountId} 
                onclose={closeCreateModal} 
                onsave={handleSaveOpportunity}>
            </c-create-opportunity>
        </template>
        
        <template if:true={isViewModalOpen}>
            <c-view-opportunity 
                opportunity-id={selectedOpportunityId} 
                onclose={closeViewModal}
                is-view-modal-open={isViewModalOpen}>
            </c-view-opportunity>
        </template>
    </lightning-card>
</template>